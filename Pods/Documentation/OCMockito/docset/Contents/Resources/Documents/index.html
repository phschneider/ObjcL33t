<!DOCTYPE HTML>
<html>
	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
		<title>OCMockito 0.23 Reference</title>
		<link rel="stylesheet" type="text/css" href="css/styles.css" media="all" />
		<link rel="stylesheet" type="text/css" media="print" href="css/stylesPrint.css" />
		<meta name="generator" content="appledoc 2.0.6 (build 789)" />
	</head>
	<body>
		<header id="top_header">
			<div id="library" class="hideInXcode">
				<h1><a id="libraryTitle" href="index.html">OCMockito 0.23 </a></h1>
				<a id="developerHome" href="index.html">Jon Reid</a>
			</div>
			
			<div id="title" role="banner">
				<h1 class="hideInXcode">OCMockito 0.23 Reference</h1>
			</div>
			<ul id="headerButtons" role="toolbar"></ul>
		</header>
		<article>
			<div id="overview_contents" role="main">
				<div class="main-navigation navigation-top">
					<a href="hierarchy.html">Next</a>
				</div>
				<div id="header">
					<div class="section-header">
						<h1 class="title title-header">OCMockito 0.23 Reference</h1>
					</div>		
				</div>
				<div id="container">
					
					<div class="section section-overview index-overview">
						
						
						<p>!<a href="http://docs.mockito.googlecode.com/hg/latest/org/mockito/logo.jpg">mockito</a></p>

<p>OCMockito is an Objective-C implementation of Mockito, supporting creation,
verification and stubbing of mock objects.</p>

<p>Key differences from other mocking frameworks:</p>

<ul>
<li><p>Mock objects are always &ldquo;nice,&rdquo; recording their calls instead of throwing
exceptions about unspecified invocations. This makes tests less fragile.</p></li>
<li><p>No expect-run-verify, making tests more readable. Mock objects record their
calls, then you verify the methods you want.</p></li>
<li><p>Verification failures are reported as unit test failures, identifying specific
lines instead of throwing exceptions. This makes it easier to identify
failures. (It also keeps the pre-iOS 5 Simulator from crashing.)</p></li>
</ul>


<h1>Adding OCMockito to your project</h1>

<p><strong>Building:</strong></p>

<p>If you want to build OCMockito yourself, cd to the Source folder, then</p>

<pre><code>$ ./MakeDistribution.sh
</code></pre>

<p>Or just use the pre-built release available in
<a href="https://github.com/jonreid/OCMockito/downloads">Downloads</a>.</p>

<p><strong>Mac Project Setup:</strong></p>

<p>Add both OCHamcrest.framework and OCMockito.framework and to your project.</p>

<p>Add a Copy Files build phase to copy both OCHamcrest.framework and
OCMockito.framework and to your Products Directory. For unit test bundles, make
sure this Copy Files phase comes before the Run Script phase that executes
tests.</p>

<p>Add:</p>

<pre><code>#define HC_SHORTHAND
#import &lt;OCHamcrest/OCHamcrest.h&gt;

#define MOCKITO_SHORTHAND
#import &lt;OCMockito/OCMockito.h&gt;
</code></pre>

<p>Note: If your Console shows</p>

<pre><code>otest[57510:203] *** NSTask: Task create for path '...' failed: 22, "Invalid argument". Terminating temporary process.
</code></pre>

<p>double-check your Copy Files phase.</p>

<p><strong>iOS Project Setup:</strong></p>

<p>Add both OCHamcrestIOS.framework and OCMockitoIOS.framework to your project.</p>

<p>Add:</p>

<pre><code>#define HC_SHORTHAND
#import &lt;OCHamcrestIOS/OCHamcrestIOS.h&gt;

#define MOCKITO_SHORTHAND
#import &lt;OCMockitoIOS/OCMockitoIOS.h&gt;
</code></pre>

<h1>Let&rsquo;s verify some behavior!</h1>

<pre><code>// mock creation
NSMutableArray *mockArray = mock([NSMutableArray class]);

// using mock object
[mockArray addObject:@"one"];
[mockArray removeAllObjects];

// verification
[verify(mockArray) addObject:@"one"];
[verify(mockArray) removeAllObjects];
</code></pre>

<p>Once created, the mock will remember all interactions. Then you can selectively
verify whatever interactions you are interested in.</p>

<h1>How about some stubbing?</h1>

<pre><code>// mock creation
NSArray *mockArray = mock([NSArray class]);

// stubbing
[given([mockArray objectAtIndex:0]) willReturn:@"first"];

// following prints "(null)" because objectAtIndex:999 was not stubbed
NSLog(@"%@", [mockArray objectAtIndex:999]);
</code></pre>

<h1>How do you mock a class object?</h1>

<pre><code>Class mockStringClass = mockClass([NSString class]);
</code></pre>

<h1>How do you mock a protocol?</h1>

<pre><code>id &lt;MyDelegate&gt; delegate = mockProtocol(@protocol(MyDelegate));
</code></pre>

<h1>How do you mock an object that also implements a protocol?</h1>

<pre><code>UIViewController &lt;CustomProtocol&gt; *controller =
    mockObjectAndProtocol([UIViewController class], @protocol(CustomProtocol));
</code></pre>

<h1>How do you stub methods that return non-objects?</h1>

<p>To stub methods that return non-object types, specify <code>willReturn&lt;type&gt;</code>,
like this:</p>

<pre><code>[given([mockArray count]) willReturnUnsignedInteger:3];
</code></pre>

<h1>Argument matchers</h1>

<p>OCMockito verifies argument values by testing for equality. But when extra
flexibility is required, you can specify
 <a href="https://github.com/hamcrest/OCHamcrest"><code>OCHamcrest</code></a> matchers.</p>

<pre><code>// mock creation
NSMutableArray *mockArray = mock([NSMutableArray class]);

// using mock object
[mockArray removeObject:@"This is a test"];

// verification
[verify(mockArray) removeObject:startsWith(@"This is")];
</code></pre>

<p>OCHamcrest matchers can be specified as arguments for both verification and
stubbing.</p>

<h1>How do you specify matchers for primitive arguments?</h1>

<p>To stub a method that takes a primitive argument but specify a matcher, invoke
the method with a dummy argument, then call <code>-withMatcher:forArgument:</code></p>

<pre><code>[[given([mockArray objectAtIndex:0]) withMatcher:anything() forArgument:0]
 willReturn:@"foo"];
</code></pre>

<p>Use the shortcut <code>-withMatcher:</code> to specify a matcher for a single argument:</p>

<pre><code>[[given([mockArray objectAtIndex:0]) withMatcher:anything()]
 willReturn:@"foo"];
</code></pre>

<h1>Verifying exact number of invocations / at least x / never</h1>

<pre><code>// using mock
[mockArray addObject:@"once"];

[mockArray addObject:@"twice"];
[mockArray addObject:@"twice"];

// the following two verifications work exactly the same
[verify(mockArray) addObject:@"once"];
[verifyCount(mockArray, times(1)) addObject:@"once"];

// verify exact number of invocations
[verifyCount(mockArray, times(2)) addObject:@"twice"];
[verifyCount(mockArray, times(3)) addObject:@"three times"];

// verify using never(), which is an alias for times(0)
[verifyCount(mockArray, never()) addObject:@"never happened"];

// verify using atLeast
[verifyCount(mockArray, atLeastOnce()) addObject:@"at least once"];
[verifyCount(mockArray, atLeast(2)) addObject:@"at least twice"];
</code></pre>

<h1>More resources</h1>

<ul>
<li><a href="https://github.com/jonreid/OCMockito">Sources</a></li>
<li><a href="https://github.com/hamcrest/OCHamcrest">OCHamcrest</a></li>
<li><a href="http://qualitycoding.org/">Quality Coding</a> &ndash; Tools, tips &amp;
techniques for <em>building quality in</em> to iOS development.</li>
</ul>

						
						
					</div>
					
                        
                    
					
					
					<div class="index-column">
						<h2 class="index-title">Class References</h2>
						<ul>
							
							<li><a href="Classes/MKTAtLeastTimes.html">MKTAtLeastTimes</a></li>
							
							<li><a href="Classes/MKTBaseMockObject.html">MKTBaseMockObject</a></li>
							
							<li><a href="Classes/MKTClassObjectMock.html">MKTClassObjectMock</a></li>
							
							<li><a href="Classes/MKTExactTimes.html">MKTExactTimes</a></li>
							
							<li><a href="Classes/MKTException.html">MKTException</a></li>
							
							<li><a href="Classes/MKTInvocationContainer.html">MKTInvocationContainer</a></li>
							
							<li><a href="Classes/MKTInvocationMatcher.html">MKTInvocationMatcher</a></li>
							
							<li><a href="Classes/MKTMockAwareVerificationMode.html">MKTMockAwareVerificationMode</a></li>
							
							<li><a href="Classes/MKTMockingProgress.html">MKTMockingProgress</a></li>
							
							<li><a href="Classes/MKTMockitoCore.html">MKTMockitoCore</a></li>
							
							<li><a href="Classes/MKTObjectAndProtocolMock.html">MKTObjectAndProtocolMock</a></li>
							
							<li><a href="Classes/MKTObjectMock.html">MKTObjectMock</a></li>
							
							<li><a href="Classes/MKTOngoingStubbing.html">MKTOngoingStubbing</a></li>
							
							<li><a href="Classes/MKTProtocolMock.html">MKTProtocolMock</a></li>
							
							<li><a href="Classes/MKTStubbedInvocationMatcher.html">MKTStubbedInvocationMatcher</a></li>
							
							<li><a href="Classes/MKTVerificationData.html">MKTVerificationData</a></li>
							
						</ul>
					</div>
					
					
						
					<div class="index-column">
						
						<h2 class="index-title">Protocol References</h2>
						<ul>
							
							<li><a href="Protocols/MKTPrimitiveArgumentMatching.html">MKTPrimitiveArgumentMatching</a></li>
							
							<li><a href="Protocols/MKTVerificationMode.html">MKTVerificationMode</a></li>
							
						</ul>
						
						
					</div>
					
				</div>
				<div class="main-navigation navigation-bottom">
					<a href="hierarchy.html">Next</a>
				</div>
				<div id="footer">
					<hr />
					<div class="footer-copyright">
						<p><span class="copyright">&copy; 2013 Jon Reid. All rights reserved. (Last updated: 2013-02-25)</span><br />
						
						<span class="generator">Generated by <a href="http://appledoc.gentlebytes.com">appledoc 2.0.6 (build 789)</a>.</span></p>
						
	
					</div>
				</div>
			</div>
		</article>		
	</body>
</html>